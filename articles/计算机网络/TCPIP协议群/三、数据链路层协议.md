# 三、数据链路层

[[_TOC_]]

## 1. 数据链路层

**由来**：数据链路层规定了电信号的分组方式，单纯的 0、1 电信号没有任何意义，必须规定电信号多少位为一组，每组什么意思

**作用**：数据链路层主要负责将数据帧 (一组电信号)，传输给物理的连接在同一传输介质上的设备 (计算机、交换机、路由器)

### (1) 交换机

交换机主要用于组建局域网，交换机一般至少有 8 个交换端口，可以将多台计算机连接起来，与交换机相连的计算机组建成了一个局域网

### (2) 网络拓扑

网络的连接和构成的形态被称为网络拓扑，网络拓扑包括总线型、环型、星型、网状型等等，拓扑一词不仅用于直观可见的配线方式，也用于逻辑上的网络组成结构，两者有时可能会不一致

![网络拓扑](https://github.com/yuyuyuzhang/Blog/blob/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCPIP%E5%8D%8F%E8%AE%AE%E7%BE%A4/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91.png)

### (3) MAC 地址

#### ① 网卡

* 以太网协议规定，接入 Internet 的设备都必须具有网卡，数据帧中报头 head 的发送方地址和接收方地址指的就是网卡的地址，也就是 MAC 地址

* 网卡 NIC 用于计算机连接局域网功能，计算机必须具备能够接入无线网的网卡才能保证连接到局域网

* 网卡可以被集成到计算机的主板，也可以单独插入计算机的扩展槽

#### ② MAC 地址

制造厂商针对每块网卡分别指定的全世界唯一的地址

* 具备唯一性：MAC 地址可以通过制造商识别号、制造商内部产品编号、产品通用编号确保 MAC 地址的唯一性

* 不具备层次性：无法确定哪家厂商的哪块网卡被用到了哪个地方，因此 MAC 地址不具备层次性

## 2. 以太网协议

以太网协议工作在数据链路层和物理层

**物理层**：以太网协议使用同轴电缆或双绞线电缆作为传输介质，可以将电信号转换成 0、1 的二进制信息，并且将 0、1 的二进制信息传给物理的传输介质

**数据链路层**：以太网协议规定一组电信号为数据帧，并将数据帧传输给物理的连接在同一传输介质上的设备 (计算机、交换机、路由器)

### (1) 面向无连接

以太网协议采用面向无连接的数据传输方式，传输数据前无需建立连接

### (2) 以太网数据帧

以太网协议规定一组电信号构成一个数据帧，每个数据帧分成报头 head 和数据 data 两部分，一个数据帧能容纳的最大数据范围是 `46 ~ 1500` 个字节

① 目标 MAC 地址

② 源 MAC 地址

③ 类型：上一层网络层使用的协议类型

④ FCS：FCS 用来检查数据帧是否有所损坏，通信传输过程中如果出现电子噪声的干扰，可能会影响发送数据导致乱码位的出现，检查 FCS 字段可以将错误帧丢弃

![以太网数据帧](https://github.com/yuyuyuzhang/Blog/blob/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCPIP%E5%8D%8F%E8%AE%AE%E7%BE%A4/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/%E4%BB%A5%E5%A4%AA%E7%BD%91%E6%95%B0%E6%8D%AE%E5%B8%A7.png)

### (3) 以太网分类

① 因通信介质的不同与通信速度的差异，衍生出了众多的以太网类型，BASE 前面的数字代表传输速度 (单位每秒比特 Mbps)，BASE 后面的字符代表传输介质，

② 传输速度不同的情况下，必须采用允许变更速度的交换机，

③ 传输速度相同而传输介质不同的情况下，可以连接允许更换传输介质的交换机

![以太网分类](https://github.com/yuyuyuzhang/Blog/blob/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCPIP%E5%8D%8F%E8%AE%AE%E7%BE%A4/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%88%86%E7%B1%BB.png)

## 3. PPP 协议

PPP 协议工作在数据链路层，

**物理层**：PPP 协议与物理层没有任何关系，因此仅有 PPP 协议无法实现通信，还需要有物理层的支持，PPP 协议可以使用的物理层支持有电话线、ISDN、专线、ATM 线路

**数据链路层**：PPP 协议规定一组电信号为数据帧，并将数据帧传输给物理的连接在同一传输介质上的设备 (计算机、交换机、路由器)

![PPP协议](https://github.com/yuyuyuzhang/Blog/blob/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCPIP%E5%8D%8F%E8%AE%AE%E7%BE%A4/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/PPP%20%E5%8D%8F%E8%AE%AE.png)

### (1) 面向有连接

① PPP 协议 (Point-to-Point Protocol) 是指点对点、一对一连接计算机的协议

② PPP 协议的主要功能包含 2 个协议，一个是不依赖上层的 LCP (Link Control Protocol) 协议，一个是依赖上层的 NCP (Network Control Protocol) 协议，如果上层是 IP 协议，那么 NCP 协议也叫做 IPCP 协议

③ PPP 协议采用面向有连接的传输方式，使用 PPP 协议进行数据传输前，要先建立一个 PPP 级的连接，这个连接建立以后，就可以进行身份验证、压缩与加密

④ 通过 PPP 协议连接时，通常需要进行用户名和密码的验证，并且是对通信双方验证，验证协议有 2 种，分别为 PAP (Password Authentication Protocol) 协议和 CHAP (Challenge Handshake Authentication Protocol) 协议

### (2) LCP 协议

LCP 协议主要负责建立和断开连接，设置最大接收单元，设置验证协议，设置是否进行通信质量的监控

### (3) IPCP 协议

IPCP 协议主要负责 IP 地址的设置，以及是否进行 TCP/IP 首部压缩等

### (4) PAP 协议

PAP 协议在 PPP 连接建立时，通过 2 次握手进行用户名和密码验证，密码以明文方式传输，因此一般用于安全要求不是很高的环境

### (5) CHAP 协议

CHAP 协议使用一次性密码 OTM (One Time Password) 验证，在建立 PPP 连接后还可以进行定期的密码交换，用来验证对端是否中途被替换

### (6) PPP 数据帧

![PPP数据帧](https://github.com/yuyuyuzhang/Blog/blob/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCPIP%E5%8D%8F%E8%AE%AE%E7%BE%A4/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/PPP%E6%95%B0%E6%8D%AE%E5%B8%A7.png)

## 4. PPPoE 协议

PPPoE 协议是在以太网协议上提供 PPP 协议的功能

**由来**：单纯的以太网协议没有验证用户名密码的功能，也没有建立和断开连接的功能，因此无法实现按时计费，而采用 PPPoE 协议管理以太网连接，就可以使用 PPP 协议的验证用户名密码和建立断开连接的功能，就能够使各家 ISP 更有效地管理终端用户的使用

![以太网PPPoE数据帧](https://github.com/yuyuyuzhang/Blog/blob/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCPIP%E5%8D%8F%E8%AE%AE%E7%BE%A4/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/%E4%BB%A5%E5%A4%AA%E7%BD%91PPPoE%E6%95%B0%E6%8D%AE%E5%B8%A7.png)

## 5. 无线通信协议

无线通信协议工作在数据链路层和物理层

**物理层**：无线通信协议使用电磁波、红外线等无线传输介质，可以将电信号转换成 0、1 的二进制信息，并且将 0、1 的二进制信息传给物理的传输介质

**数据链路层**：无线通信协议规定一组电信号为数据帧，并将数据帧传输给物理的连接在同一传输介质上的设备 (计算机、交换机、路由器)

### (1) 面向无连接

无线通信协议采用面向有连接的数据传输方式，传输数据前需要建立连接，传输完成后断开连接

### (2) 无线通信种类

无线通信依据通信距离可分为 6 种类型，如下所示：

![无线通信类型](https://github.com/yuyuyuzhang/Blog/blob/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCPIP%E5%8D%8F%E8%AE%AE%E7%BE%A4/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/%E6%97%A0%E7%BA%BF%E9%80%9A%E4%BF%A1%E7%B1%BB%E5%9E%8B.png)

### (3) 蓝牙

① 蓝牙属于无线 PAN，通信距离在 10 米左右

② 蓝牙是为手机、鼠标、键盘等较小设备设计的标准，如蓝牙鼠标 (无线)，蓝牙键盘 (无线)

### (4) Wifi

① Wifi 属于无线 LAN，通信距离在 100 米左右

② Wifi 允许使用者可以自由地移动位置，自由地放置设备，通过无线电波实现较广范围的通信

③ 在 Wifi 的通信范围内，任何人都可以使用，因此会有被盗听或篡改的风险，Wifi 为防止盗听和篡改，可对传输数据进行加密，也可以对访问 Wifi 的设备进行访问控制，有利于构建更安全的网络环境

④ Wifi 允许无需牌照就可以使用特定频段，因此 Wifi 的无线电波可能收到其他通信设备的干扰，导致信号不稳定，例如在一台微波炉附近使用一个 2.4GHz 带宽的 802.11b/g 设备就需要注意，微波炉启动后放射出来的无线电波与设备频率十分相近，产生的干扰会显著降低设备的传输能力

### (5) 移动通信网络

移动通信网络属于无线 WAN，可以通过基站实现长距离通信
