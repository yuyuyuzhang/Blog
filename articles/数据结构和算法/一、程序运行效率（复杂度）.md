# 一、程序运行效率

## 1. 复杂度

### (1) 效率低下的系统

一个效率低下的系统，程序执行几个小时，甚至好几天，或者是执行过程中电脑直接死机

* 如果这个系统是离线的：会让开发周期、测试周期变得很长
* 如果这个系统是在线的：随时具有时间爆炸或内存爆炸的可能性

### (2) 如何衡量代码运行效率（复杂度）

计算机通过一个个程序去执行`计算任务`，就是对输入数据进行加工，得到最终输出结果的过程，每个程序都是由代码构成的，因此编写代码的核心就是要`完成计算`，但对于同一个计算任务，不同`计算方法`得到结果的过程的复杂程度是不一样的，这对实际的任务处理效率有非常大的影响

因此复杂度是衡量代码运行效率的重要度量因素

例如在一个在线系统中实时处理数据，假设这个系统平均每分钟新增 300M 数据量，如果代码不能在 1 分钟内完成这 300M 数据量的处理，这个系统就会发生时间爆炸和空间爆炸，表现就是电脑执行越来越慢直至死机

因此我们需要使用合理的计算方法，通过尽可能低复杂程度的代码完成计算任务

### (3) 如何衡量复杂度（时间、空间）

降低复杂度首先需要知道如何衡量复杂度，衡量复杂度首先需要知道这段代码消耗的资源是什么？一般情况下代码执行过程中会消耗计算时间和计算空间，因此衡量因素就是时间复杂度和空间复杂度

例如某个十字路口没有建立立交桥，所有车辆通过红绿灯分批次通过，当大量汽车通过路口时，就会分别消耗大家的时间，但是建立立交桥后，所有车辆都可以同时通过，因此立交桥的存在相当于消耗空间资源换取时间资源

### (4) 如何计算复杂度

通常我们不会关注`代码对于资源消耗的绝对量`，因为无论是时间还是空间，其`源消耗程度都与输入数据量高度相关`，为了更客观的衡量资源消耗程度，通常关注`资源消耗量与输入数据量之间的关系`

复杂度是一个关于输入数据量 n 的函数 `O(f(n))`

* 复杂度与具体的常系数无关
* 多项式级的复杂度相加时，以高者作为结果
* `O(1)` 表示资源消耗与输入数据量无关

代码任务：对于一个输入数组，输出其逆序数组

* 方法一

  ```javascript
  //时间复杂度：O(n)，一个for循环
  //空间复杂度：O(n)，新数组result和输入数组arr长度相等
  function reverse1(arr){
    const result = []
    for(let i=0; i<arr.length; i++){
      result[arr.length-i-1] = arr[i]
    }
    return result
  }
  ```

* 方法二

  ```javascript
  //时间复杂度：O(n)
  //空间复杂度：O(1)，一个变量 tmp
  function reserve2(arr){
    let tmp = 0
    for(let i=0; i<(arr.length/2); i++){
      [arr[arr.length-i-1], arr[i]] = [arr[i], arr[arr.length-i-1]]
    }
    return arr
  }
  ```

## 2. 降低复杂度

### (1) 降低空间复杂度的核心思路

* 去除`无效的存储`
* 空间复杂度与`数据结构`紧密相关，能用`低复杂度的数据结构`解决问题，就不要用高复杂度的数据结构

### (2) 降低时间复杂度的核心思路

* 去除`无效的计算`
* 时间复杂度与`代码结构`紧密相关，采用`高效的算法`例如递归、二分法、排序算法、动态规划等等

### (3) 空间廉价、时间昂贵（时空转换）

代码效率的瓶颈发生在时间和空间两个方面，如果缺少空间可以花钱购买服务器，如果缺少时间只能投入时间跑程序，没有其他办法，因此相比空间复杂度，时间复杂度的降低更加重要，故而空间是廉价的，时间是昂贵的

### (4) 降低复杂度的核心思路

* **暴力解法**：在没有任何时间和空间的约束下，完成代码任务的开发
* **无效操作处理**：剔除无效的存储和无效的计算
* **时空转换**：设计合理的数据结构，采用合理的算法，完成时间复杂度到空间复杂度的转换
